<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modal Drag Demo</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { padding: 20px; }
        .modal-header { cursor: move; user-select: none; }
        .modal.dragging .modal-dialog { transition: none !important; }
        .modal.dragging { user-select: none; }
    </style>
</head>
<body>
    <h1>Modal Drag Demo</h1>
    <button class="btn btn-primary" onclick="showModal()">Show Draggable Modal</button>

    <!-- Modal -->
    <div class="modal fade" id="testModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Draggable Modal</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <p>This modal can be dragged! Click and hold on the header to move it around.</p>
                    <p><strong>Instructions:</strong></p>
                    <ul>
                        <li>Click and hold on the header (title bar)</li>
                        <li>Drag the modal to a new position</li>
                        <li>Release to drop the modal</li>
                    </ul>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary">Save changes</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        function showModal() {
            const modal = new bootstrap.Modal(document.getElementById('testModal'));
            modal.show();
        }

        // Make modals draggable using pure JavaScript
        function makeModalsDraggable() {
            console.log('Making modals draggable...');

            // Use event delegation for better performance
            document.addEventListener('mousedown', function(e) {
                // Check if clicked on modal header
                if (e.target.closest('.modal-header')) {
                    const modalHeader = e.target.closest('.modal-header');
                    const modal = modalHeader.closest('.modal');
                    const modalDialog = modal.querySelector('.modal-dialog');

                    if (!modalDialog) return;

                    console.log('Starting modal drag');

                    // Add dragging class
                    modal.classList.add('dragging');

                    let startX = e.clientX;
                    let startY = e.clientY;
                    const rect = modalDialog.getBoundingClientRect();
                    let initialX = rect.left;
                    let initialY = rect.top;

                    // Set initial position
                    modalDialog.style.position = 'fixed';
                    modalDialog.style.left = initialX + 'px';
                    modalDialog.style.top = initialY + 'px';
                    modalDialog.style.transform = 'none';
                    modalDialog.style.margin = '0';

                    function moveModal(e) {
                        const deltaX = e.clientX - startX;
                        const deltaY = e.clientY - startY;

                        let newX = initialX + deltaX;
                        let newY = initialY + deltaY;

                        // Constrain to window bounds with some padding
                        const padding = 10;
                        const maxX = window.innerWidth - modalDialog.offsetWidth - padding;
                        const maxY = window.innerHeight - modalDialog.offsetHeight - padding;

                        newX = Math.max(padding, Math.min(newX, maxX));
                        newY = Math.max(padding, Math.min(newY, maxY));

                        modalDialog.style.left = newX + 'px';
                        modalDialog.style.top = newY + 'px';
                    }

                    function stopDrag() {
                        console.log('Modal drag completed');
                        modal.classList.remove('dragging');
                        document.removeEventListener('mousemove', moveModal);
                        document.removeEventListener('mouseup', stopDrag);
                    }

                    document.addEventListener('mousemove', moveModal);
                    document.addEventListener('mouseup', stopDrag);

                    // Prevent default behavior
                    e.preventDefault();
                }
            });

            // Reset modal position when hidden
            document.addEventListener('hidden.bs.modal', function(e) {
                const modal = e.target;
                const modalDialog = modal.querySelector('.modal-dialog');
                if (modalDialog) {
                    modalDialog.style.position = '';
                    modalDialog.style.left = '';
                    modalDialog.style.top = '';
                    modalDialog.style.transform = '';
                    modalDialog.style.margin = '';
                }
            });

            console.log('Modal drag functionality initialized');
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', function() {
            makeModalsDraggable();
        });
    </script>
</body>
</html>


